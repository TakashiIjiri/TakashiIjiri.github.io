<html>

<head>
  <meta charset="utf-8">
  <title>RoiPainter I/O</title>
  <link rel="stylesheet" type="text/css" media="screen" href="../style.css">
</head>



<body>

<div id="MainBody600">

  <h1>RoiPainter I/O</h1>
  <p align="right"> <a href="#eng"> English </a> </p>
  <div id="StdContents">
    <img src="img/RoiPainter3D.png" width=600pt >
  </div>

  <h3>
    <a href="index.html"     > RoiPainter    </a> &nbsp;
    <a href="io.html"        > I/O           </a> &nbsp;
    <a href="vis.html"       > Visualization </a> &nbsp;
    <a href="segm/index.html"> Segmentation  </a> &nbsp;
    <a href="dl/index.html"  > Download      </a> &nbsp;
    <a href="https://github.com/InteractiveGraphicsLab/RoiPainter3Dv2"> code (github)</a> &nbsp;
  </h3>
  <br>
  <hr>


  <h2>I/O in RoiPainter</h2>

  <div id="StdContents">
    RoiPainter3Dで画像を読み込むには「Menu > File」 より読み込みたい画像形式に該当する項目をクリックします．
    また「Menu > File」より，マスクデータの読み込み・書き出し・3Dモデルとして書き出しや，画像データの書き出しなども可能です．
  </div>


  <span id="ArrangeLR">
    <span id="ArrangeLR40_left">
      <img src="img/io_menu.png" width=95%>
    </span>
    <span id="ArrangeLR40_right">
      <a href="#D1">D-1) file > Open slices (bmp, tif)      </a><br>
      <a href="#D2">D-2) file > Open slices (dcm)           </a><br>
      <a href="#D3">D-3) file > Open 3D Volume (traw3d)     </a><br>
      <a href="#D4">D-4) file > Open 3D Volume (dcm)        </a><br>
      <a href="#D5">D-5) file > Open 3D Volume (fav)        </a><br>
      <a href="#D6">D-6) file > Open 3D Volume (pnm, sph)   </a><br>
      <!--a href="#D2">D-2) file > Open Weather data (.txt)</a><br -->
      <a href="#M1">M-1) file > Save Mask (msk)             </a><br>
      <a href="#M2">M-2) file > Load Mask (msk)             </a><br>
      <!--a href="#M3">M-3) file > Save Mask as fav</a><br -->
      <a href="#E1">E-1) file > Export a ROI as fav         </a><br>
      <a href="#E2">E-2) file > Export some ROIs as obj mesh</a><br>
      <a href="#E3">E-3) file > Export All ROIs as color bmp</a><br>
      <a href="#E4">E-4) file > Export a ROI as binary bmp  </a><br>
      <a href="#E5">E-5) file > Export volume as traw3d_ss  </a><br>
      <a href="#E6">E-6) file > Export volume as bmp slices </a><br>
    </span>
  </span>


  <hr>
  <h2>Open Volume data (D-1 ~ D-6)</h2>
  <div id="StdContents">
    <div id="D1" style="margin-bottom:1em">
      <b>D-1) file > Open slices (bmp, tif) </b> :
      2次元スライス画像（bmpまたはtif）を読み込めます．
      一連のスライスはすべて同じサイズ（幅x高）である必要があります．カラー画像も読み込めますが，自動的にグレースケール画像に変換されます．
    </div>

    <div id="D2" style="margin-bottom:1em">
      <b>D-2) file > Open slices (dcm) </b> :
      Dicom スライス画像を読み込みます．
      実装にはDCMTKを利用しています．
    </div>

    <div id="D3" style="margin-bottom:1em">
      <b>D-3) file > Open 3D Volume (traw3d_ss)</b> :
      独自形式 traw3d_ss ファイルを読み込みます．このファイルは，ピッチ情報を持ち，一つの画素をsigned short（16bit）として保持します．
      データフォーマットの詳細については<a href="http://www.riken.jp/brict/Ijiri/flowerctlib/index.html">こちら</a>を参照してください．
    </div>

    <div id="D4" style="margin-bottom:1em">
      <b>D-4) file > Open 3D Volume (dcm)</b> :
      3次元Dicom画像（ひとつのDicomファイルで3次元画像を保持する形式）を読み込みます．
    </div>

    <div id="D5" style="margin-bottom:1em">
      <b>D-5) file > Open 3D Volume (fav)</b> :
      fav形式の3次元画像を読み込みます（実装中）
    </div>

    <div id="D6" style="margin-bottom:1em">
      <b>D-6) file > Open 3D Volume (pvm, sph)</b> :
      pvmまたはsph形式の3次元画像を読み込みます．
    </div>
  </div>

  <hr>
  <h2>Save and Load Mask</h2>
  <div id="StdContents">
    <div id="M1" style="margin-bottom:1em">
      <b>M-1) file > Save Mask (msk)</b> :
      作成したマスクデータを独自形式（.msk）で保存します．
    </div>

    <div id="M2" style="margin-bottom:1em">
      <b>M-2) file > Load Mask (msk)</b> :
      マスクデータ（.msk）を読み込みます．
      ソフトウエア上でマスクを作成中・編集中の場合，そのマスクデータが上書きされるので注意してください．
    </div>
  </div>


  <hr>
  <h2>Export</h2>
  <div id="StdContents">
    <div id="E1" style="margin-bottom:1em">
      <b>E-1) file > Export a ROI as fav</b> :
      （実装中）作成したマスクデータを，.fav形式にて出力します．
      fav形式の詳細は<a href="https://www.fujixerox.co.jp/company/technical/communication/3d/fav.html">こちら</a>を参照.
    </div>

    <div id="E2" style="margin-bottom:1em">
      <b>E-2) file > Export some ROIs as obj mesh</b> :
      作成したマスクデータから複数の領域(ROI)を選択し，それらをひとつのメッシュモデル（obj）として出力します．
      出力の際，平滑化の回数も指定できます．
    </div>

    <div id="E3" style="margin-bottom:1em">
      <b>E-3) file > Export All ROIs as color bmp</b> :
      作成したマスクデータをカラーのbmpスライスデータとして出力します．
    </div>

    <div id="E4" style="margin-bottom:1em">
      <b>E-4) file > Export a ROI as binary bmp</b> :
      作成したマスクデータからひとつの領域(ROI)を選択して，バイナリbitmapスライスデータとして出力します．
    </div>

    <div id="E5" style="margin-bottom:1em">
      <b>E-5) file > Export volume as traw3d_ss</b> :
      現在読み込んである画像データをtraw3d_ss形式にて保存します．
    </div>

    <div id="E6" style="margin-bottom:1em">
      <b>E-6) file > Export volume as bmp slices </b> :
      現在読み込んである画像データをbmp sliceとして保存します．
      現在指定しているWinLvMin / WinLvMaxがトーンマッピングにそのまま利用されます．
    </div>
  </div>


  <hr>
  <h2>Export and Import camera position</h2>
  <div id="StdContents">
    上記のほかに「Menu > Miscs」 よりカメラの位置を書き出し・読み込みが可能です．
    論文の図表作成の際に同じ位置にカメラを配置したい事があるため実装しました．

    <div id="C1" style="margin-bottom:1em">
      <b>C-1) MISCS > Export Current Camera</b> : 現在のカメラ位置をテキスト形式で保存します．
    </div>
    <div id="C2" style="margin-bottom:1em">
      <b>C-2) MISCS &gt; Import Camera Position</b> : 上で保存したカメラ位置情報を読み込み，カメラ位置を移動します．
    </div>
  </div>



  <hr>
  <h2>入力データを積み重ねる方向について</h2>

  <div id="StdContents">
    RoiPainterは，bmp/dcm/tifなど二次元スライス画像や，traw3d_ss/3d dicomなどの3次元画像を読み込みます．
    これら3次元画像は，左上が原点（右方向がx軸の正，下方向がy軸の正）の二次元画像を積み重ねた構造を持ちます．<br>
    画像データ・マスクデータの読み込むと以下のダイアログを表示されます．
    このダイアログより画像をスタックする方向を指定してください．ダイアログ中の図の通り，3次元空間の原点は左上手前になります．<br>
    <br>
    <img src="img/z_stack_dialog.png" width="400pt"><br>
    <br>
    <b>※ dcmなど積み重ねる方向をデータ内に含む画像については，自動的に決定されます．</b><br>
    <!--b>※ 読み込み時にDescending orderを選択した場合，その後画像やマスクをexportすると，z軸方向に反転したものが出力されます．</b><br>-->
    <b>※ マスクロードの際には，画像読み込み時と同じスタック方向を指定する必要があります．</b><br>
  </div>

  <div id="StdContents">
    <a href="../index.html"> RoiPainter3D Top </a>
  </div>




<!-------------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------------->


  <h1 id="eng">RoiPainter I/O</h1>
  <p align="right"> <a href="./io.html"> Japanese </a> </p>
  <div id="StdContents">
    <img src="img/RoiPainter3D.png" width=600pt >
  </div>

  <h3>
    <a href="index.html#eng"     > RoiPainter    </a> &nbsp;
    <a href="io.html#eng"        > I/O           </a> &nbsp;
    <a href="vis.html#eng"       > Visualization </a> &nbsp;
    <a href="segm/index.html#eng"> Segmentation  </a> &nbsp;
    <a href="dl/index.html#eng"  > Download      </a> &nbsp;
    <a href="https://github.com/InteractiveGraphicsLab/RoiPainter3Dv2"> code (github)</a> &nbsp;
  </h3>
  <br>
  <hr>


  <h2>I/O in RoiPainter</h2>

  <div id="StdContents">
    To load a volume image in RoiPainter3D, click "Menu > File" and select menu item corresponds to the image format.
    RoiPainter3D also supports saving/loading mask data, exporting 3D model, and exporting 3D images.
  </div>


  <span id="ArrangeLR">
    <span id="ArrangeLR40_left">
      <img src="img/io_menu.png" width=95%>
    </span>
    <span id="ArrangeLR40_right">
      <a href="#D1">D-1) file > Open slices (bmp, tif)      </a><br>
      <a href="#D2">D-2) file > Open slices (dcm)           </a><br>
      <a href="#D3">D-3) file > Open 3D Volume (traw3d)     </a><br>
      <a href="#D4">D-4) file > Open 3D Volume (dcm)        </a><br>
      <a href="#D5">D-5) file > Open 3D Volume (fav)        </a><br>
      <a href="#D6">D-6) file > Open 3D Volume (pnm, sph)   </a><br>
      <!--a href="#D2">D-2) file > Open Weather data (.txt)</a><br -->
      <a href="#M1">M-1) file > Save Mask (msk)             </a><br>
      <a href="#M2">M-2) file > Load Mask (msk)             </a><br>
      <!--a href="#M3">M-3) file > Save Mask as fav</a><br -->
      <a href="#E1">E-1) file > Export a ROI as fav         </a><br>
      <a href="#E2">E-2) file > Export some ROIs as obj mesh</a><br>
      <a href="#E3">E-3) file > Export All ROIs as color bmp</a><br>
      <a href="#E4">E-4) file > Export a ROI as binary bmp  </a><br>
      <a href="#E5">E-5) file > Export volume as traw3d_ss  </a><br>
      <a href="#E6">E-6) file > Export volume as bmp slices </a><br>
    </span>
  </span>


  <hr>
  <h2>Open Volume data (D-1 ~ D-6)</h2>
  <div id="StdContents">
    <div id="D1" style="margin-bottom:1em">
      <b>D-1) file > Open slices (bmp, tif) </b> :
      This item is to load 2D slice images (bmp or tif).
      The series of slices must all be of the same size (width x height).
      Color images can be imported, but they are automatically converted to grayscale images.
    </div>

    <div id="D2" style="margin-bottom:1em">
      <b>D-2) file > Open slices (dcm) </b> :
      This item is to load Dicom slice images.
      DCMTK was used for implementation.
    </div>

    <div id="D3" style="margin-bottom:1em">
      <b>D-3) file > Open 3D Volume (traw3d_ss)</b> :
      This item is to load a traw3d_ss file (our original format).
      In this file format, pitch information is contained and a voxel is represented with a signed short (16bit).
      see <a href="http://www.riken.jp/brict/Ijiri/flowerctlib/index.html">this link </a> for detailed information on traw3d_ss.
    </div>

    <div id="D4" style="margin-bottom:1em">
      <b>D-4) file > Open 3D Volume (dcm)</b> :
      This item is to load 3D Dicom image.
    </div>

    <div id="D5" style="margin-bottom:1em">
      <b>D-5) file > Open 3D Volume (fav)</b> :
      This item is to load 3D volume image represented in fav format (under construction).
    </div>

    <div id="D6" style="margin-bottom:1em">
      <b>D-6) file > Open 3D Volume (pvm, sph)</b> :
      This item is to load a pvm or sph file.
    </div>
  </div>

  <hr>
  <h2>Save and Load Mask</h2>
  <div id="StdContents">
    <div id="M1" style="margin-bottom:1em">
      <b>M-1) file > Save Mask (msk)</b> :
      This item saves edited mask (label) data as .msk file (original format).
    </div>

    <div id="M2" style="margin-bottom:1em">
      <b>M-2) file > Load Mask (msk)</b> :
      This item loads a mask (.msk) data.
      Notice that if a mask data is being edited in the software, it will be overwritten.
    </div>
  </div>


  <hr>
  <h2>Export</h2>
  <div id="StdContents">
    <div id="E1" style="margin-bottom:1em">
      <b>E-1) file > Export a ROI as fav</b> :
      This item exports mask data as .fav file (under construction).
      see <a href="https://www.fujixerox.co.jp/company/technical/communication/3d/fav.html">here</a> for more information on .fav.
    </div>

    <div id="E2" style="margin-bottom:1em">
      <b>E-2) file > Export some ROIs as obj mesh</b> :
      This item is to export mask data as 3D mesh model (obj). After clicking this item, select one or multiple ROI(s) and select the number of smoothing, the system then export the selected ROI as a mesh model.
    </div>

    <div id="E3" style="margin-bottom:1em">
      <b>E-3) file > Export All ROIs as color bmp</b> :
      This item is to export mask data as color bmp slice.
    </div>

    <div id="E4" style="margin-bottom:1em">
      <b>E-4) file > Export a ROI as binary bmp</b> :
      This item is to export a selected ROI as a binary bmp slice.
    </div>

    <div id="E5" style="margin-bottom:1em">
      <b>E-5) file > Export volume as traw3d_ss</b> :
      This item exports the volume image as traw3d_ss.
    </div>

    <div id="E6" style="margin-bottom:1em">
      <b>E-6) file > Export volume as bmp slices </b> :
      This item exports the currently loaded volume as bmp slices.
      Currently specified WinLv_min and WinLv_max are used for tonemapping.
    </div>
  </div>


  <hr>
  <h2>Export and Import camera position</h2>
  <div id="StdContents">
    RoiPainter3D also supports to export and import the camera position from "Menu > Miscs".
    This is implemented because I often want to place the camera at the same position when creating figures for a paper.

    <div id="C1" style="margin-bottom:1em">
      <b>C-1) MISCS > Export Current Camera</b> : This item exports the current camera position.
    </div>
    <div id="C2" style="margin-bottom:1em">
      <b>C-2) MISCS &gt; Import Camera Position</b> : This item load the camera position exported by the item above.
    </div>
  </div>



  <hr>
  <h2>Stacking orientation</h2>

  <div id="StdContents">
    RoiPainter3D loads 2D slice images (bmp/dcm/tif) and 3D images (traw3d_ss/3ddicom).
    These 3D images have a stacked structure of 2D images with the origin in the upper left (x-axis is oriented in the right and y-axis is oriented in downword).
    <br><br>
    When loading image or mask, the following dialog will be displayed.
    Please specify the direction to stack the images from this dialog.
    As in the figure, the origin of the 3D space is at the upper left front corner. <br>
    <br>
    <img src="img/z_stack_dialog.png" width="400pt"><br>
    <br>
    <b>※ For images that contain stacking directions such as DCM, the satcking oriention is automatically determined.</b><br>
    <b>※ When loading a mask, it is necessary to specify the same stack direction as when loading the image.</b><br>
  </div>

  <div id="StdContents">
    <a href="../index.html"> RoiPainter3D Top </a>
  </div>

</div>
</body>
</html>
